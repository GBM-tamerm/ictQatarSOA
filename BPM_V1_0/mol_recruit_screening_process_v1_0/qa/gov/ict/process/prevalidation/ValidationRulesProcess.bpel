<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:java="http://ict.gov.qa/IGOVError/xml/schemas/version1.0" xmlns:java0="http://ict.gov.qa/IGOVError/xml/schemas/version1_0/" xmlns:ns="http://LR_PreconditionValidationProcess/qa/gov/ict/process/prevalidation/ValidationRulesProcessArtifacts" xmlns:ns0="http:///ict.gov.qa/Process/XSD/IPreconditionValidation/v1" xmlns:ns1="http://LR_PreconditionValidationProcess/qa/gov/ict/process/wsdl/IValidateEstablishment" xmlns:ns10="http://mol.gov.qa/labor/recruitmentApplication/xml/schemas/version1_0/" xmlns:ns11="http://mol.gov.qa/labor/recruitmentApplication/specifications/versions1_0/EstablishmentLaborInfo/" xmlns:ns12="http://mol.gov.qa/labor/recruitmentApplication/specifications/versions1_0/LaborRecruitmentBusinessRules/" xmlns:ns13="http://moi.gov.qa/establishmentInfo/specifications/version1_0/EstablishmentSecurityInfo/" xmlns:ns14="mol.gov.qa/customerService/recruitment/specifications/v1_0/" xmlns:ns15="igov.gov.qa/xml/schemas/v1_0/" xmlns:ns16="moi.gov.qa/establishmentInfo/specifications/v1_0/" xmlns:ns17="moi.gov.qa/establishmentInfo/xml/schemas/v1_0/" xmlns:ns18="kahramaa.com.qa/billing/xml/schemas/v1_0/" xmlns:ns19="mol.gov.qa/customerService/recruitment/xml/schemas/v1_0/" xmlns:ns2="http://mol.gov.qa/Establishment/EstablishmentLaborInfo/version/1.0" xmlns:ns20="urn:moi.gov.qa/establishmentInfo/xml/schemas/v1_0/" xmlns:ns21="urn:mol.gov.qa/customerService/recruitment/specifications/v1_0/" xmlns:ns22="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/" xmlns:ns23="urn:kahramaa.com.qa/billing/xml/schemas/v1_0/" xmlns:ns24="urn:igov.gov.qa/xml/schemas/v1_0/" xmlns:ns25="urn:mol.gov.qa/customerService/recruitment/xml/schemas/v1_0/" xmlns:ns26="urn:igov.gov.qa/commonTypes/xml/schemas/v1_0/" xmlns:ns27="http://mol_recruit_process_lib/process/IPrepareGovHeader" xmlns:ns28="urn:kahramaa.com.qa/billing/specifications/v1_0/" xmlns:ns3="http:///ict.gov.qa/Process/XSD/commonTypes/v1" xmlns:ns4="http://ict.gov.qa/CommonTypes/xml/schemas/version1.0" xmlns:ns5="http://mol.gov.qa/Labor/RecruitmentBusinessRules/version/1.0" xmlns:ns6="http://moi.gov.qa/Establishment/EStablishmentSecurityInfo/version/1.0" xmlns:ns7="http://schemas.ict.gov.qa/2010/01/iGovHeader" xmlns:ns8="http://ict.gov.qa/Notification/NotificationService/version/1.0" xmlns:ns9="http:///ict.gov.qa/Process/XSD/ProcessHeader" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="ValidationRulesProcess" suppressJoinFailure="yes" targetNamespace="http://LR_PreconditionValidationProcess/qa/gov/ict/process/prevalidation" wpc:autoDelete="onSuccessfulCompletion" wpc:autonomy="peer" wpc:compensationSphere="supports" wpc:continueOnError="yes" wpc:displayName="ValidationRulesProcess" wpc:executionMode="microflow" wpc:id="6" wpc:ignoreMissingData="yes" wpc:validFrom="2010-02-10T09:17:47">
  <wpc:javaGlobals>
    <wpc:import packages="qa.gov.mol.lr.process.constants.IExceptionHandelerConstants"/>
    <wpc:import packages="qa.gov.mol.lr.process.util.ExceptionHandeler"/>
    <wpc:import packages="qa.gov.mol.lr.process.util.ProcessUtil"/>
    <wpc:import packages="qa.gov.mol.lr.process.constants.BusinessKeys"/>
    <wpc:import packages="java.util.Map"/>
    <wpc:import packages="java.util.HashMap"/>
  </wpc:javaGlobals>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../wsdl/IValidateEstablishment.wsdl" namespace="http://LR_PreconditionValidationProcess/qa/gov/ict/process/wsdl/IValidateEstablishment"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../xsd-includes/http..ict.gov.qa.Process.XSD.IPreconditionValidation.v1.xsd" namespace="http:///ict.gov.qa/Process/XSD/IPreconditionValidation/v1"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="ValidationRulesProcessArtifacts.wsdl" namespace="http://LR_PreconditionValidationProcess/qa/gov/ict/process/prevalidation/ValidationRulesProcessArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../services/EstablishmentLaborInfo-v1-0.wsdl" namespace="http://mol.gov.qa/Establishment/EstablishmentLaborInfo/version/1.0"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../process/ProcessCommonTypes-v1.xsd" namespace="http:///ict.gov.qa/Process/XSD/commonTypes/v1"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../services/CommonTypes-v1-0.xsd" namespace="http://ict.gov.qa/CommonTypes/xml/schemas/version1.0"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../services/LaborRecruitmentBusinessRules-v1-0.wsdl" namespace="http://mol.gov.qa/Labor/RecruitmentBusinessRules/version/1.0"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../services/EstablishmentSecurityInfo-v1-0.wsdl" namespace="http://moi.gov.qa/Establishment/EStablishmentSecurityInfo/version/1.0"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../xsd-includes/http.schemas.ict.gov.qa.2010.01.iGovHeader.xsd" namespace="http://schemas.ict.gov.qa/2010/01/iGovHeader"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../services/CommonError-v1-0.xsd" namespace="http://ict.gov.qa/IGOVError/xml/schemas/version1.0"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../services/NotificationService-v1-0.wsdl" namespace="http://ict.gov.qa/Notification/NotificationService/version/1.0"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../xsd-includes/http..ict.gov.qa.Process.XSD.ProcessHeader.xsd" namespace="http:///ict.gov.qa/Process/XSD/ProcessHeader"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/labor/recruitmentApplication/specifications/versions1_0/EstablishmentLaborInfo.wsdl" namespace="http://mol.gov.qa/labor/recruitmentApplication/specifications/versions1_0/EstablishmentLaborInfo/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../xsd-includes/http.mol.gov.qa.labor.recruitmentApplication.xml.schemas.version1_0.xsd" namespace="http://mol.gov.qa/labor/recruitmentApplication/xml/schemas/version1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../ict/gov/qa/IGOVError/xml/schemas/version1_0/CommonErrorStructure.xsd" namespace="http://ict.gov.qa/IGOVError/xml/schemas/version1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/labor/recruitmentApplication/specifications/versions1_0/LaborRecruitmentBusinessRules.wsdl" namespace="http://mol.gov.qa/labor/recruitmentApplication/specifications/versions1_0/LaborRecruitmentBusinessRules/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../moi/gov/qa/establishmentInfo/specifications/version1_0/EstablishmentSecurityInfo.wsdl" namespace="http://moi.gov.qa/establishmentInfo/specifications/version1_0/EstablishmentSecurityInfo/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/customerService/recruitment/specifications/v1_0/LaborRecruitmentInfo_v1_0.wsdl" namespace="mol.gov.qa/customerService/recruitment/specifications/v1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../igov/gov/qa/xml/schemas/v1_0/IgovHeader_v1_0.xsd" namespace="urn:igov.gov.qa/xml/schemas/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../moi/gov/qa/establishmentInfo/specifications/v1_0/EstablishmentSecurityInfo_v1_0.wsdl" namespace="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../moi/gov/qa/establishmentInfo/xml/schemas/v1_0/EstablishmentSecurity_v1_0.xsd" namespace="urn:moi.gov.qa/establishmentInfo/xml/schemas/v1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../kahramaa/com/qa/billing/xml/schemas/v1_0/Billing_v1_0.xsd" namespace="urn:kahramaa.com.qa/billing/xml/schemas/v1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../mol/gov/qa/customerService/recruitment/xml/schemas/v1_0/LaborRecruitment_v1_0.xsd" namespace="urn:mol.gov.qa/customerService/recruitment/xml/schemas/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/customerService/recruitment/specifications/v1_0/BlacklistedEstablishmentInfo_v1_0.wsdl" namespace="urn:mol.gov.qa/customerService/recruitment/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/customerService/recruitment/specifications/v1_0/EstablishmentHasActiveLaborAppInfo_v1_0.wsdl" namespace="urn:mol.gov.qa/customerService/recruitment/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/customerService/recruitment/specifications/v1_0/LaborRecruitmentBusinessRules_v1_0.wsdl" namespace="urn:mol.gov.qa/customerService/recruitment/specifications/v1_0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../igov/gov/qa/commonTypes/xml/schemas/v1_0/CommonTypes_v1_0.xsd" namespace="urn:igov.gov.qa/commonTypes/xml/schemas/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../process/IPrepareGovHeader.wsdl" namespace="http://mol_recruit_process_lib/process/IPrepareGovHeader"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../process/IPrepareGovHeader.wsdl" namespace="http://mol_recruit_process_lib/process/IPrepareGovHeader"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/mol_recruit_process_lib_v1_0/kahramaa/com/qa/billing/specifications/v1_0/BillingInfo_v1_0.wsdl" namespace="urn:kahramaa.com.qa/billing/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../mol/gov/qa/customerService/recruitment/specifications/v1_0/RecruitmentProcessPreconditionValidation_v1_0.wsdl" namespace="urn:mol.gov.qa/customerService/recruitment/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../kahramaa/com/qa/billing/specifications/v1_0/BillingInfo_v1_0.wsdl" namespace="urn:kahramaa.com.qa/billing/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/mol_recruit_process_lib_v1_0/moi/gov/qa/establishmentInfo/specifications/v1_0/EstablishmentRestrictionInfo_v1_0.wsdl" namespace="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../moi/gov/qa/establishmentInfo/specifications/v1_0/EstablishmentLaborStatisticsInfo_v1_0.wsdl" namespace="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../moi/gov/qa/establishmentInfo/specifications/v1_0/EstablishmentRestrictionInfo_v1_0.wsdl" namespace="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/mol_recruit_process_lib_v1_0/moi/gov/qa/establishmentInfo/specifications/v1_0/EstablishmentLaborStatisticsInfo_v1_0.wsdl" namespace="urn:moi.gov.qa/establishmentInfo/specifications/v1_0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/mol_recruit_process_lib_v1_0/process/IPrepareGovHeader.wsdl" namespace="http://mol_recruit_process_lib/process/IPrepareGovHeader"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="Interface" name="IValidateEstablishment" partnerLinkType="ns:IValidateEstablishmentPLT"/>
    <bpws:partnerLink name="EstHasActiveAppPartner" partnerLinkType="ns:EstLaborInfoPartnerPLT" partnerRole="Reference"/>
    <bpws:partnerLink name="LaborBusinessRules" partnerLinkType="ns:LaborBusinessRulesPLT" partnerRole="Reference"/>
    <bpws:partnerLink name="EstIsBlackListedPartner" partnerLinkType="ns:EstIsBlackListedPartnerPLT" partnerRole="Reference"/>
    <bpws:partnerLink name="BillInfoPartner" partnerLinkType="ns:BillInfoPLT" partnerRole="Interface"/>
    <bpws:partnerLink name="EstablishmentLaborStatisticsInfoPartner" partnerLinkType="ns:EstablishmentLaborStatisticsInfoPLT" partnerRole="Interface"/>
    <bpws:partnerLink name="IPrepareGovHeaderPartner" partnerLinkType="ns:IPrepareGovHeaderPLT" partnerRole="Interface"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="validationResults" type="ns25:ValidationResults" wpc:id="5"/>
    <bpws:variable name="eGovHeader" type="ns24:IGOVHeaderType" wpc:id="16"/>
    <bpws:variable name="inValidResults" type="ns25:InValidType" wpc:id="20"/>
    <bpws:variable name="callHasActiveAppRequired" type="xsd:boolean" wpc:id="94"/>
    <bpws:variable name="estID" type="ns20:EstablishmentIdType" wpc:id="64"/>
    <bpws:variable name="pHeader" type="ns25:ProcessHeader" wpc:id="65"/>
    <bpws:variable name="electricityNo" type="ns23:ElectricityNumberType" wpc:id="224"/>
    <bpws:variable messageType="ns1:validateEstablishment_faultMsg" name="fault" wpc:id="68"/>
    <bpws:variable name="hasActiveAppRequest" type="ns21:hasEstablishmentActiveLaborRecAppRequest" wpc:id="86"/>
    <bpws:variable name="hasActiveAppResponse" type="ns21:hasEstablishmentActiveLaborRecAppResponse" wpc:id="87"/>
    <bpws:variable name="isEstBlacklistRequest" type="ns21:isEstablishmentBlacklistedRequest" wpc:id="88"/>
    <bpws:variable name="isEstBlacklistResponse" type="ns21:isEstablishmentBlacklistedResponse" wpc:id="89"/>
    <bpws:variable name="checkEstRequest" type="ns21:checkEstablishmentRequest" wpc:id="90"/>
    <bpws:variable name="checkEstResponse" type="ns21:checkEstablishmentResponse" wpc:id="91"/>
    <bpws:variable name="isRestrictedRequest" type="ns22:IsRestrictedRequest" wpc:id="92"/>
    <bpws:variable name="getBillSummaryRequest" type="ns28:GetLastBillSummaryRequest" wpc:id="219"/>
    <bpws:variable name="getBillSummaryResponse" type="ns28:GetLastBillSummaryResponse" wpc:id="220"/>
    <bpws:variable name="getStatisticsRequest" type="ns22:getLaborStatisticsRequest" wpc:id="221"/>
    <bpws:variable name="getStatisticsResponse" type="ns22:getLaborStatisticsResponse" wpc:id="222"/>
    <bpws:variable name="isRestrictedResponse" type="ns22:IsRestrictedResponse" wpc:id="93"/>
    <bpws:variable name="error" type="ns26:CommonErrorStructure" wpc:id="107"/>
    <bpws:variable name="withInfo" type="xsd:boolean" wpc:id="223"/>
    <bpws:variable name="ServiceNo" type="xsd:int" wpc:id="238"/>
  </bpws:variables>
  <bpws:sequence name="HiddenSequence" wpc:id="1073742083">
    <bpws:receive createInstance="yes" name="Receive" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" wpc:displayName="Receive" wpc:id="2" wpc:transactionalBehavior="commitAfter">
      <wpc:output>
        <wpc:parameter name="estID" variable="estID"/>
        <wpc:parameter name="pHeader" variable="pHeader"/>
        <wpc:parameter name="callHasActiveAppRequired" variable="callHasActiveAppRequired"/>
        <wpc:parameter name="electricityNo" variable="electricityNo"/>
        <wpc:parameter name="withInfo" variable="withInfo"/>
      </wpc:output>
    </bpws:receive>
    <bpws:scope name="Scope" wpc:displayName="Scope" wpc:id="142">
      <bpws:faultHandlers>
        <bpws:catch faultMessageType="ns21:EstablishmentHasActiveLaborAppInfohasEstablishmentActiveLaborRecAppFault" faultName="ns21:hasEstablishmentActiveLaborRecAppFault" faultVariable="Variable" wpc:variableId="145">
          <bpws:sequence name="HiddenSequence16" wpc:id="1073741970">
            <bpws:invoke name="getexception1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="get exception" wpc:id="101">
              <wpc:script>
                <wpc:javaCode><![CDATA[com.ibm.bpe.api.ApplicationFaultException exp= (com.ibm.bpe.api.ApplicationFaultException)getCurrentFaultAsException();
error=(commonj.sdo.DataObject)exp.getFaultMessage();
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="setcommonerror" wpc:displayName="set common error" wpc:id="108">
              <bpws:copy>
                <bpws:from variable="error"/>
                <bpws:to part="fault" variable="fault"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:reply faultName="ns1:fault" name="Replywithfault1" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" variable="fault" wpc:displayName="Reply with fault" wpc:id="104"/>
            <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="105"/>
          </bpws:sequence>
        </bpws:catch>
        <bpws:catch faultMessageType="ns21:BlacklistedEstablishmentsInfoisEstablishmentBlacklistedFault" faultName="ns21:isEstablishmentBlacklistedFault" faultVariable="Variable1" wpc:variableId="147">
          <bpws:sequence name="HiddenSequence8" wpc:id="1073741972">
            <bpws:invoke name="getexception" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="get exception" wpc:id="149">
              <wpc:script>
                <wpc:javaCode><![CDATA[com.ibm.bpe.api.ApplicationFaultException exp= (com.ibm.bpe.api.ApplicationFaultException)getCurrentFaultAsException();
error=(commonj.sdo.DataObject)exp.getFaultMessage();


]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="setcommonerror1" wpc:displayName="set common error" wpc:id="150">
              <bpws:copy>
                <bpws:from variable="error"/>
                <bpws:to part="fault" variable="fault"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:reply faultName="ns1:fault" name="Replywithfault2" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" variable="fault" wpc:displayName="Reply with fault" wpc:id="151"/>
            <bpws:terminate name="Terminate2" wpc:displayName="Terminate" wpc:id="152"/>
          </bpws:sequence>
        </bpws:catch>
        <bpws:catch faultMessageType="ns21:LaborRecruitmentBusinessRulescheckEstablishmentFault" faultName="ns21:checkEstablishmentFault" faultVariable="Variable2" wpc:variableId="153">
          <bpws:sequence name="HiddenSequence9" wpc:id="1073741978">
            <bpws:invoke name="getexception2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="get exception" wpc:id="155">
              <wpc:script>
                <wpc:javaCode><![CDATA[com.ibm.bpe.api.ApplicationFaultException exp= (com.ibm.bpe.api.ApplicationFaultException)getCurrentFaultAsException();
error=(commonj.sdo.DataObject)exp.getFaultMessage();
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="setcommonerror2" wpc:displayName="set common error" wpc:id="156">
              <bpws:copy>
                <bpws:from variable="error"/>
                <bpws:to part="fault" variable="fault"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:reply faultName="ns1:fault" name="Replywithfault3" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" variable="fault" wpc:displayName="Reply with fault" wpc:id="157"/>
            <bpws:terminate name="Terminate3" wpc:displayName="Terminate" wpc:id="158"/>
          </bpws:sequence>
        </bpws:catch>
        <bpws:catchAll>
          <bpws:sequence name="HiddenSequence15" wpc:id="1073741968">
            <bpws:invoke name="handleexception" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="handle exception" wpc:id="51">
              <wpc:script>
                <wpc:javaCode><![CDATA[// get the failed service
String serviceID=null;
switch(ServiceNo){
	case 1:	serviceID=IExceptionHandelerConstants.hasActiveApp;
			break;
	case 2:	serviceID=IExceptionHandelerConstants.blacklist;
			break;
	case 3:	serviceID=IExceptionHandelerConstants.businessRules;
			break;
	case 4:	serviceID=IExceptionHandelerConstants.isRestricted;
			break;
	case 5:	serviceID=IExceptionHandelerConstants.statistics;
			break;
	case 6:	serviceID=IExceptionHandelerConstants.billInfo;
			break;
}
com.ibm.bpe.api.BpelException exp= (com.ibm.bpe.api.BpelException)getCurrentFaultAsException();
String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
error=ExceptionHandeler.getInstance().handleUnmodeledExpDO(IExceptionHandelerConstants.PerformScreening,serviceID,exp,keys);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="setfaultvariable1" wpc:displayName="set fault variable" wpc:id="57">
              <bpws:copy>
                <bpws:from variable="error"/>
                <bpws:to part="fault" variable="fault"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:reply faultName="ns1:fault" name="Replywithfault" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" variable="fault" wpc:displayName="Reply with fault" wpc:id="61"/>
            <bpws:terminate name="Terminate" wpc:displayName="Terminate" wpc:id="96"/>
          </bpws:sequence>
        </bpws:catchAll>
      </bpws:faultHandlers>
      <bpws:flow name="validaitonservices" wpc:displayName="validaiton services" wpc:id="170">
        <bpws:links>
          <bpws:link name="Link" wpc:displayName="Link" wpc:id="176"/>
          <bpws:link name="Link1" wpc:displayName="Link1" wpc:id="187"/>
          <bpws:link name="Link2" wpc:displayName="Link2" wpc:id="188"/>
          <bpws:link name="Link3" wpc:displayName="Link3" wpc:id="189"/>
          <bpws:link name="Link4" wpc:displayName="Link4" wpc:id="190"/>
          <bpws:link name="Link5" wpc:displayName="Link5" wpc:id="191"/>
          <bpws:link name="Link6" wpc:displayName="Link6" wpc:id="192"/>
          <bpws:link name="Link7" wpc:displayName="Link7" wpc:id="193"/>
          <bpws:link name="Link8" wpc:displayName="Link8" wpc:id="194"/>
          <bpws:link name="Link9" wpc:displayName="Link9" wpc:id="195"/>
          <bpws:link name="Link10" wpc:displayName="Link10" wpc:id="177"/>
          <bpws:link name="Link11" wpc:displayName="Link11" wpc:id="178"/>
          <bpws:link name="Link12" wpc:displayName="Link12" wpc:id="179"/>
          <bpws:link name="Link13" wpc:displayName="Link13" wpc:id="180"/>
          <bpws:link name="Link17" wpc:displayName="Link17" wpc:id="250"/>
          <bpws:link name="Link20" wpc:displayName="Link20" wpc:id="254"/>
          <bpws:link name="Link16" wpc:displayName="Link16" wpc:id="255"/>
          <bpws:link name="Link25" wpc:displayName="Link25" wpc:id="260"/>
          <bpws:link name="Link26" wpc:displayName="Link26" wpc:id="261"/>
          <bpws:link name="Link14" wpc:displayName="Link14" wpc:id="273"/>
          <bpws:link name="Link15" wpc:displayName="Link15" wpc:id="274"/>
          <bpws:link name="Link18" wpc:displayName="Link18" wpc:id="278"/>
          <bpws:link name="Link19" wpc:displayName="Link19" wpc:id="279"/>
          <bpws:link name="Link21" wpc:displayName="Link21" wpc:id="281"/>
          <bpws:link name="Link23" wpc:displayName="Link23" wpc:id="283"/>
        </bpws:links>
        <bpws:invoke name="loginput" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log input" wpc:id="271">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logInput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.hasActiveApp,hasActiveAppRequest,keys);
]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link1"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link14"/>
          </bpws:sources>
        </bpws:invoke>
        <bpws:empty name="callhasactiveapplication" wpc:displayName="call has active application?" wpc:id="171">
          <bpws:sources>
            <bpws:source linkName="Link">
              <bpws:transitionCondition><![CDATA[return callHasActiveAppRequired.booleanValue();
]]></bpws:transitionCondition>
            </bpws:source>
            <bpws:source linkName="Link5">
              <bpws:transitionCondition><![CDATA[return !callHasActiveAppRequired.booleanValue();]]></bpws:transitionCondition>
            </bpws:source>
          </bpws:sources>
        </bpws:empty>
        <bpws:assign name="setServiceinputs" wpc:displayName="set Service inputs" wpc:id="10">
          <bpws:targets>
            <bpws:target linkName="Link"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link1"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from variable="estID"/>
            <bpws:to variable="hasActiveAppRequest">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[estID]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>1</bpws:from>
            <bpws:to variable="ServiceNo"/>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="checkHasActiveApplications" operation="hasEstablishmentActiveLaborRecApp" partnerLink="EstHasActiveAppPartner" portType="ns21:EstablishmentHasActiveLaborAppInfo" wpc:continueOnError="inherit" wpc:displayName="check Has Active Applications" wpc:id="7">
          <wpc:input>
            <wpc:parameter name="estID" variable="hasActiveAppRequest"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="hasActiveApp" variable="hasActiveAppResponse"/>
          </wpc:output>
          <bpws:targets>
            <bpws:target linkName="Link14"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link15"/>
          </bpws:sources>
        </bpws:invoke>
        <bpws:assign name="populateInvalidresults" wpc:displayName="populate Invalid results " wpc:id="21">
          <bpws:targets>
            <bpws:target linkName="Link2"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link3"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from><![CDATA[MOL]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[agency]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from><![CDATA[ACTIVE_APP]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[service]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from variable="inValidResults"/>
            <bpws:to variable="validationResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[inValidResults]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:reply name="Replywithinvalidresults" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" wpc:displayName="Reply with invalid results" wpc:id="23">
          <wpc:input>
            <wpc:parameter name="validationResults" variable="validationResults"/>
          </wpc:input>
          <bpws:targets>
            <bpws:target linkName="Link3"/>
          </bpws:targets>
        </bpws:reply>
        <bpws:assign name="setServiceinputs1" wpc:displayName="set Service inputs" wpc:id="74">
          <bpws:targets>
            <bpws:target linkName="Link5"/>
            <bpws:target linkName="Link8"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link4"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from variable="estID"/>
            <bpws:to variable="isEstBlacklistRequest">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[estID]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>2</bpws:from>
            <bpws:to variable="ServiceNo"/>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="loginput1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log input" wpc:id="277">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logInput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.blacklist,isEstBlacklistRequest,keys);]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link4"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link18"/>
          </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="checkLaborblackList" operation="isEstablishmentBlacklisted" partnerLink="EstIsBlackListedPartner" portType="ns21:BlacklistedEstablishmentsInfo" wpc:displayName="check Labor blackList" wpc:id="11">
          <wpc:input>
            <wpc:parameter name="estID" variable="isEstBlacklistRequest"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="blacklisted" variable="isEstBlacklistResponse"/>
          </wpc:output>
          <bpws:targets>
            <bpws:target linkName="Link18"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link19"/>
          </bpws:sources>
        </bpws:invoke>
        <bpws:assign name="populateInvalidresults1" wpc:displayName="populate Invalid results " wpc:id="27">
          <bpws:targets>
            <bpws:target linkName="Link6"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link7"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from><![CDATA[MOL]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[agency]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from><![CDATA[BLACKLIST]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[service]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from variable="inValidResults"/>
            <bpws:to variable="validationResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[inValidResults]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:reply name="Replywithinvalidresults1" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" wpc:displayName="Reply with invalid results" wpc:id="28">
          <wpc:input>
            <wpc:parameter name="validationResults" variable="validationResults"/>
          </wpc:input>
          <bpws:targets>
            <bpws:target linkName="Link7"/>
          </bpws:targets>
        </bpws:reply>
        <bpws:assign name="setServiceinputs2" wpc:displayName="set Service inputs" wpc:id="75">
          <bpws:targets>
            <bpws:target linkName="Link9"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link10"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from variable="estID"/>
            <bpws:to variable="checkEstRequest">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[estID]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>3</bpws:from>
            <bpws:to variable="ServiceNo"/>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="checkaddionalbusinessrules" operation="checkEstablishment" partnerLink="LaborBusinessRules" portType="ns21:LaborRecruitmentBusinessRules" wpc:continueOnError="inherit" wpc:displayName="check addional business rules" wpc:id="71">
          <wpc:input>
            <wpc:parameter name="estID" variable="checkEstRequest"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="validEstblishment" variable="checkEstResponse"/>
          </wpc:output>
          <bpws:targets>
            <bpws:target linkName="Link21"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link23"/>
          </bpws:sources>
        </bpws:invoke>
        <bpws:assign name="populateInvalidresults3" wpc:displayName="populate Invalid results " wpc:id="81">
          <bpws:targets>
            <bpws:target linkName="Link11"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link12"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from><![CDATA[MOL]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[agency]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from><![CDATA[ADDITIONAL_RULES]]></bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[service]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from variable="checkEstResponse">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[rejectionReason]]></bpws:query>
            </bpws:from>
            <bpws:to variable="inValidResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[molRejectionReason]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from variable="inValidResults"/>
            <bpws:to variable="validationResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[inValidResults]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:reply name="Replywithinvalidresults3" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" wpc:displayName="Reply with invalid results" wpc:id="82">
          <wpc:input>
            <wpc:parameter name="validationResults" variable="validationResults"/>
          </wpc:input>
          <bpws:targets>
            <bpws:target linkName="Link12"/>
          </bpws:targets>
        </bpws:reply>
        <bpws:assign name="populatevalidresults1" wpc:displayName="populate valid results" wpc:id="172">
          <bpws:targets>
            <bpws:target linkName="Link13"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link16"/>
          </bpws:sources>
          <bpws:copy>
            <bpws:from><![CDATA[N/A]]></bpws:from>
            <bpws:to variable="validationResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/statisticsNote]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from><![CDATA[N/A]]></bpws:from>
            <bpws:to variable="validationResults">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/electricityNote]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:empty name="callinformationservices" wpc:displayName="call  information services?" wpc:id="225">
          <bpws:targets>
            <bpws:target linkName="Link16"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link20">
              <bpws:transitionCondition><![CDATA[return withInfo.booleanValue();]]></bpws:transitionCondition>
            </bpws:source>
            <bpws:source linkName="Link26">
              <bpws:transitionCondition><![CDATA[return !withInfo.booleanValue();
]]></bpws:transitionCondition>
            </bpws:source>
          </bpws:sources>
        </bpws:empty>
        <bpws:scope name="Scope1" wpc:displayName="Scope1" wpc:id="242">
          <bpws:targets>
            <bpws:target linkName="Link20"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link17"/>
          </bpws:sources>
          <bpws:faultHandlers>
            <bpws:catch faultMessageType="ns22:EstablishmentLaborStatisticsInfogetLaborStatisticsFault" faultName="ns22:getLaborStatisticsFault" faultVariable="Variable5" wpc:variableId="263">
              <bpws:sequence name="HiddenSequence6" wpc:id="1073742088">
                <bpws:invoke name="getexception5" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="get exception" wpc:id="265">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[com.ibm.bpe.api.ApplicationFaultException exp= (com.ibm.bpe.api.ApplicationFaultException)getCurrentFaultAsException();
error=(commonj.sdo.DataObject)exp.getFaultMessage();
String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ExceptionHandeler.getInstance().handleModeledExp(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.statistics,error,keys);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="populatestatisticsnote2" wpc:displayName="populate statistics note" wpc:id="266">
                  <bpws:copy>
                    <bpws:from variable="error">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorCode]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="validationResults">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/statisticsNote]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
              </bpws:sequence>
            </bpws:catch>
            <bpws:catchAll>
              <bpws:sequence name="HiddenSequence4" wpc:id="1073742068">
                <bpws:invoke name="handleexception2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="handle exception" wpc:id="245">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[com.ibm.bpe.api.BpelException exp= (com.ibm.bpe.api.BpelException)getCurrentFaultAsException();
String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
error=ExceptionHandeler.getInstance().handleUnmodeledExpDO(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.statistics,exp,keys);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="populatestatisticsnote1" wpc:displayName="populate statistics note" wpc:id="246">
                  <bpws:copy>
                    <bpws:from variable="error">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorCode]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="validationResults">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/statisticsNote]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
              </bpws:sequence>
            </bpws:catchAll>
          </bpws:faultHandlers>
          <bpws:sequence name="HiddenSequence3" wpc:id="1073742067">
            <bpws:assign name="setServiceinputs4" wpc:displayName="set Service inputs" wpc:id="247">
              <bpws:copy>
                <bpws:from variable="estID"/>
                <bpws:to variable="getStatisticsRequest">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[estID]]></bpws:query>
                </bpws:to>
              </bpws:copy>
              <bpws:copy>
                <bpws:from>5</bpws:from>
                <bpws:to variable="ServiceNo"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:invoke name="loginput3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log input" wpc:id="284">
              <wpc:script>
                <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logInput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.statistics,getStatisticsRequest,keys);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:invoke name="getEststatistics" operation="getLaborStatistics" partnerLink="EstablishmentLaborStatisticsInfoPartner" portType="ns22:EstablishmentLaborStatisticsInfo" wpc:displayName="get Est statistics" wpc:id="196">
              <wpc:input>
                <wpc:parameter name="estID" variable="getStatisticsRequest"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="laborStatistics" variable="getStatisticsResponse"/>
              </wpc:output>
            </bpws:invoke>
            <bpws:invoke name="logoutput3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log output" wpc:id="285">
              <wpc:script>
                <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logOutput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.statistics,getStatisticsResponse,keys);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="populatestatistics1" wpc:displayName="populate statistics" wpc:id="212">
              <bpws:copy>
                <bpws:from variable="getStatisticsResponse">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[estStatistics]]></bpws:query>
                </bpws:from>
                <bpws:to variable="validationResults">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/statistics]]></bpws:query>
                </bpws:to>
              </bpws:copy>
            </bpws:assign>
          </bpws:sequence>
        </bpws:scope>
        <bpws:scope name="Scope2" wpc:displayName="Scope2" wpc:id="248">
          <bpws:targets>
            <bpws:target linkName="Link17"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link25"/>
          </bpws:sources>
          <bpws:faultHandlers>
            <bpws:catch faultMessageType="ns28:BillInfogetLastBillSummaryFault" faultName="ns28:getLastBillSummaryFault" faultVariable="Variable3" wpc:variableId="267">
              <bpws:sequence name="HiddenSequence1" wpc:id="1073742092">
                <bpws:invoke name="getexception3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="get exception" wpc:id="269">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[com.ibm.bpe.api.ApplicationFaultException exp= (com.ibm.bpe.api.ApplicationFaultException)getCurrentFaultAsException();
error=(commonj.sdo.DataObject)exp.getFaultMessage();
String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.Elect_No,electricityNo);
ExceptionHandeler.getInstance().handleModeledExp(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.billInfo,error,keys);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="populateelectricitynote1" wpc:displayName="populate electricity note" wpc:id="270">
                  <bpws:copy>
                    <bpws:from variable="error">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorCode]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="validationResults">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/electricityNote]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
              </bpws:sequence>
            </bpws:catch>
            <bpws:catchAll>
              <bpws:sequence name="HiddenSequence5" wpc:id="1073742075">
                <bpws:invoke name="handleexception1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="handle exception" wpc:id="252">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[com.ibm.bpe.api.BpelException exp= (com.ibm.bpe.api.BpelException)getCurrentFaultAsException();
String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.Elect_No,electricityNo);
error=ExceptionHandeler.getInstance().handleUnmodeledExpDO(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.billInfo,exp,keys);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="populateelectricitynote2" wpc:displayName="populate electricity note" wpc:id="253">
                  <bpws:copy>
                    <bpws:from variable="error">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorCode]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="validationResults">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/electricityNote]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
              </bpws:sequence>
            </bpws:catchAll>
          </bpws:faultHandlers>
          <bpws:sequence name="HiddenSequence2" wpc:id="1073742073">
            <bpws:assign name="setServiceinputs5" wpc:displayName="set Service inputs" wpc:id="209">
              <bpws:copy>
                <bpws:from variable="electricityNo"/>
                <bpws:to variable="getBillSummaryRequest">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[elecNumber]]></bpws:query>
                </bpws:to>
              </bpws:copy>
              <bpws:copy>
                <bpws:from>6</bpws:from>
                <bpws:to variable="ServiceNo"/>
              </bpws:copy>
            </bpws:assign>
            <bpws:invoke name="prepareeGovHeader" operation="perpareGovHeader" partnerLink="IPrepareGovHeaderPartner" portType="ns27:IPrepareGovHeader" wpc:continueOnError="inherit" wpc:displayName="prepare eGov Header" wpc:id="262">
              <wpc:input>
                <wpc:parameter name="processHeader" variable="pHeader"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="govHeader" variable="eGovHeader"/>
              </wpc:output>
            </bpws:invoke>
            <bpws:invoke name="loginput4" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log input" wpc:id="286">
              <wpc:script>
                <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.Elect_No,electricityNo);
ProcessUtil.logInput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.billInfo,getBillSummaryRequest,keys);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:invoke name="getelectricityinfo" operation="getLastBillSummary" partnerLink="BillInfoPartner" portType="ns28:BillInfo" wpc:displayName="get electricity info" wpc:id="210">
              <wpc:input>
                <wpc:parameter name="header" variable="eGovHeader"/>
                <wpc:parameter name="elecNumber" variable="getBillSummaryRequest"/>
              </wpc:input>
              <wpc:output>
                <wpc:parameter name="billSummary" variable="getBillSummaryResponse"/>
              </wpc:output>
            </bpws:invoke>
            <bpws:invoke name="logoutput4" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log output" wpc:id="287">
              <wpc:script>
                <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.Elect_No,electricityNo);
ProcessUtil.logOutput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.billInfo,getBillSummaryResponse,keys);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
            <bpws:assign name="populateelectricity" wpc:displayName="populate electricity" wpc:id="211">
              <bpws:copy>
                <bpws:from variable="getBillSummaryResponse">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[billSummary]]></bpws:query>
                </bpws:from>
                <bpws:to variable="validationResults">
                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[validResult/electricityInfo]]></bpws:query>
                </bpws:to>
              </bpws:copy>
            </bpws:assign>
          </bpws:sequence>
        </bpws:scope>
        <bpws:reply name="Reply" operation="validateEstablishment" partnerLink="IValidateEstablishment" portType="ns1:IValidateEstablishment" wpc:displayName="Reply" wpc:id="258">
          <wpc:input>
            <wpc:parameter name="validationResults" variable="validationResults"/>
          </wpc:input>
          <bpws:targets>
            <bpws:target linkName="Link25"/>
            <bpws:target linkName="Link26"/>
          </bpws:targets>
        </bpws:reply>
        <bpws:invoke name="logoutput" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log output" wpc:id="272">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logOutput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.hasActiveApp,hasActiveAppResponse,keys);]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link15"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link8">
              <bpws:transitionCondition><![CDATA[return  !hasActiveAppResponse.getBoolean("estHasActiveApp");]]></bpws:transitionCondition>
            </bpws:source>
            <bpws:source linkName="Link2">
              <bpws:transitionCondition><![CDATA[return  hasActiveAppResponse.getBoolean("estHasActiveApp");
]]></bpws:transitionCondition>
            </bpws:source>
          </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="logoutput1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log output" wpc:id="282">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logOutput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.businessRules,checkEstRequest,keys);]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link23"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link13">
              <bpws:transitionCondition><![CDATA[return checkEstResponse.getBoolean("validEstablishment");]]></bpws:transitionCondition>
            </bpws:source>
            <bpws:source linkName="Link11">
              <bpws:transitionCondition><![CDATA[return !checkEstResponse.getBoolean("validEstablishment");

]]></bpws:transitionCondition>
            </bpws:source>
          </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="logoutput2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log output" wpc:id="276">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logOutput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.blacklist,isEstBlacklistResponse,keys);]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link19"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link6">
              <bpws:transitionCondition><![CDATA[return isEstBlacklistResponse.getBoolean("blacklisted");]]></bpws:transitionCondition>
            </bpws:source>
            <bpws:source linkName="Link9">
              <bpws:transitionCondition><![CDATA[return !isEstBlacklistResponse.getBoolean("blacklisted");

]]></bpws:transitionCondition>
            </bpws:source>
          </bpws:sources>
        </bpws:invoke>
        <bpws:invoke name="loginput2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="log input" wpc:id="280">
          <wpc:script>
            <wpc:javaCode><![CDATA[String userID=pHeader!=null?pHeader.getString("userID"):null;
Map keys= new HashMap();
keys.put(BusinessKeys.TrackingID,userID);
keys.put(BusinessKeys.EstID,estID);
ProcessUtil.logInput(IExceptionHandelerConstants.PerformScreening,IExceptionHandelerConstants.businessRules,checkEstRequest,keys);]]></wpc:javaCode>
          </wpc:script>
          <bpws:targets>
            <bpws:target linkName="Link10"/>
          </bpws:targets>
          <bpws:sources>
            <bpws:source linkName="Link21"/>
          </bpws:sources>
        </bpws:invoke>
      </bpws:flow>
    </bpws:scope>
  </bpws:sequence>
</bpws:process>